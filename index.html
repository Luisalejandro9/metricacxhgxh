<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Métricas para Soporte Técnico</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f7fa;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #fff;
            padding: 20px 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
        }
        .stats-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background-color: #f1f5f9;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            position: relative;
        }
        .stat-card h2 {
            margin-top: 0;
            font-size: 18px;
            color: #4a5568;
        }
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #3498db;
            margin: 10px 0;
        }
        .stat-below-standard {
            color: #e74c3c;
        }
        .stat-meets-standard {
            color: #2ecc71;
        }
        .standard-indicator {
            font-size: 0.85rem;
            margin-top: 5px;
            padding: 3px 8px;
            border-radius: 10px;
            display: inline-block;
        }
        .standard-below {
            background-color: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
        }
        .standard-meets {
            background-color: rgba(46, 204, 113, 0.1);
            color: #2ecc71;
        }
        .counters {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        .counter-card {
            background-color: #f1f5f9;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        .counter-card h3 {
            margin-top: 0;
            font-size: 16px;
            color: #4a5568;
        }
        .counter-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 15px 0;
        }
        .cases-closed {
            color: #2ecc71;
        }
        .cases-managed {
            color: #e74c3c;
        }
        .btn-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        button {
            padding: 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: background-color 0.2s, transform 0.1s;
        }
        button:active {
            transform: scale(0.97);
        }
        .btn-closed {
            background-color: #2ecc71;
            color: white;
        }
        .btn-managed {
            background-color: #3498db;
            color: white;
        }
        .btn-timer {
            grid-column: span 2;
            background-color: #9b59b6;
            color: white;
        }
        .btn-reset {
            grid-column: span 2;
            background-color: #e74c3c;
            color: white;
        }
        .timer-display {
            font-size: 1.5rem;
            text-align: center;
            font-weight: bold;
            margin-bottom: 20px;
            color: #9b59b6;
        }
        .chart-container {
            width: 100%;
            height: 200px;
            margin-top: 30px;
        }
        .mensaje-error {
            background-color: #ffdddd;
            color: #e74c3c;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            margin-bottom: 15px;
            font-weight: 500;
            opacity: 0;
            height: 0;
            transition: opacity 0.3s, height 0.3s, padding 0.3s, margin 0.3s;
            overflow: hidden;
        }
        .mensaje-error.activo {
            opacity: 1;
            height: auto;
            padding: 10px;
            margin-bottom: 15px;
        }
        .disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        .mensaje-info {
            background-color: #e0f2ff;
            color: #3498db;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            margin-bottom: 15px;
            font-weight: 500;
        }
        .standards-container {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #9b59b6;
        }
        .standards-container h3 {
            margin-top: 0;
            color: #2c3e50;
            font-size: 16px;
        }
        .standards-list {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
        }
        .standard-item {
            display: flex;
            align-items: center;
            font-size: 14px;
        }
        .standard-label {
            margin-right: 5px;
            font-weight: 500;
        }
        .standard-value {
            padding: 2px 6px;
            border-radius: 4px;
            background-color: #f0f0f0;
        }
        /* Estilos para el footer */
        .footer {
            text-align: center;
            padding: 15px;
            margin-top: 20px;
            font-size: 14px;
            color: #6c757d;
            border-top: 1px solid #eaeaea;
        }
        @media (max-width: 576px) {
            .footer {
                font-size: 12px;
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Dashboard CxH GxH para Soporte Técnico RRSS</h1>
        
        <div class="standards-container">
            <h3>Estándares de Rendimiento</h3>
            <div class="standards-list">
                <div class="standard-item">
                    <span class="standard-label">Casos cerrados por hora:</span>
                    <span class="standard-value">≥ 2.8</span>
                </div>
                <div class="standard-item">
                    <span class="standard-label">Casos gestionados por hora:</span>
                    <span class="standard-value">≥ 3.8</span>
                </div>
            </div>
        </div>
        
        <div class="timer-display" id="timer">00:00:00</div>
        
        <div id="mensajeError" class="mensaje-error">No puedes cerrar más casos de los que has gestionado</div>
        
        <div id="mensajeInfo" class="mensaje-info">Inicia el tiempo para comenzar a registrar casos</div>
        
        <div class="btn-container">
            <button id="btnClosed" class="btn-closed disabled" disabled>Añadir Caso Cerrado</button>
            <button id="btnManaged" class="btn-managed disabled" disabled>Añadir Caso Gestionado</button>
            <button id="btnTimer" class="btn-timer">Iniciar Tiempo</button>
            <button id="btnReset" class="btn-reset">Reiniciar Todo</button>
        </div>
        
        <div class="counters">
            <div class="counter-card">
                <h3>Casos Cerrados</h3>
                <div id="casesClosed" class="counter-value cases-closed">0</div>
            </div>
            <div class="counter-card">
                <h3>Casos Gestionados</h3>
                <div id="casesManaged" class="counter-value cases-managed">0</div>
            </div>
        </div>
        
        <div class="stats-container">
            <div class="stat-card">
                <h2>Porcentaje de Cierre</h2>
                <div id="closeRate" class="stat-value">0%</div>
            </div>
            <div class="stat-card">
                <h2>Casos Por Hora</h2>
                <div id="casesPerHour" class="stat-value">0</div>
                <div id="standardCasesPerHour" class="standard-indicator standard-below">Por debajo del estándar</div>
            </div>
            <div class="stat-card">
                <h2>Promedio Cerrados</h2>
                <div id="avgClosed" class="stat-value">0</div>
                <div id="standardAvgClosed" class="standard-indicator standard-below">Por debajo del estándar</div>
            </div>
            <div class="stat-card">
                <h2>Promedio Gestionados</h2>
                <div id="avgManaged" class="stat-value">0</div>
                <div id="standardAvgManaged" class="standard-indicator standard-below">Por debajo del estándar</div>
            </div>
        </div>
        
        <!-- Nuevo footer -->
        <div class="footer">
            &copy; DESARROLLADO POR LUIS ACOSTA
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Elementos del DOM
            const btnClosed = document.getElementById('btnClosed');
            const btnManaged = document.getElementById('btnManaged');
            const btnTimer = document.getElementById('btnTimer');
            const btnReset = document.getElementById('btnReset');
            const casesClosed = document.getElementById('casesClosed');
            const casesManaged = document.getElementById('casesManaged');
            const closeRate = document.getElementById('closeRate');
            const casesPerHour = document.getElementById('casesPerHour');
            const avgClosed = document.getElementById('avgClosed');
            const avgManaged = document.getElementById('avgManaged');
            const timer = document.getElementById('timer');
            const mensajeError = document.getElementById('mensajeError');
            const mensajeInfo = document.getElementById('mensajeInfo');
            const standardCasesPerHour = document.getElementById('standardCasesPerHour');
            const standardAvgClosed = document.getElementById('standardAvgClosed');
            const standardAvgManaged = document.getElementById('standardAvgManaged');
            
            // Estándares definidos
            const STANDARD_CLOSED_PER_HOUR = 2.8;
            const STANDARD_MANAGED_PER_HOUR = 3.8;
            
            // Variables para contadores
            let closedCount = 0;
            let managedCount = 0;
            let timerRunning = false;
            let timerInterval;
            let seconds = 0;
            let minutes = 0;
            let hours = 0;
            
            // Agregar controlador para prevenir refrescar la página accidentalmente
            window.addEventListener('beforeunload', function(e) {
                // Solo mostrar confirmación si hay datos registrados o el timer está corriendo
                if (closedCount > 0 || managedCount > 0 || timerRunning) {
                    // Mensaje que se mostrará (los navegadores modernos usan su propio mensaje genérico)
                    const mensaje = "¿Estás seguro de que quieres salir? Perderás todos los datos registrados.";
                    e.returnValue = mensaje; // Estándar
                    return mensaje; // Para navegadores antiguos
                }
            });
            
            // Función para mostrar mensaje de error
            function mostrarError(mensaje) {
                mensajeError.textContent = mensaje;
                mensajeError.classList.add('activo');
                
                // Ocultar el mensaje después de 3 segundos
                setTimeout(() => {
                    mensajeError.classList.remove('activo');
                }, 3000);
            }
            
            // Función para actualizar el estado de los botones
            function actualizarEstadoBotones() {
                // Verificar si el temporizador está en marcha
                if (!timerRunning) {
                    btnClosed.classList.add('disabled');
                    btnClosed.disabled = true;
                    btnManaged.classList.add('disabled');
                    btnManaged.disabled = true;
                    return;
                }
                
                // Habilitar botón de casos gestionados
                btnManaged.classList.remove('disabled');
                btnManaged.disabled = false;
                
                // Verificar si se pueden cerrar más casos
                if (closedCount >= managedCount) {
                    btnClosed.classList.add('disabled');
                    btnClosed.disabled = true;
                } else {
                    btnClosed.classList.remove('disabled');
                    btnClosed.disabled = false;
                }
            }
            
            // Función para actualizar los indicadores de estándares
            function actualizarIndicadoresEstandares(closedPerHour, managedPerHour) {
                // Verificar estándar para casos cerrados
                if (closedPerHour >= STANDARD_CLOSED_PER_HOUR) {
                    avgClosed.classList.remove('stat-below-standard');
                    avgClosed.classList.add('stat-meets-standard');
                    standardAvgClosed.classList.remove('standard-below');
                    standardAvgClosed.classList.add('standard-meets');
                    standardAvgClosed.textContent = "Cumple el estándar";
                } else {
                    avgClosed.classList.remove('stat-meets-standard');
                    avgClosed.classList.add('stat-below-standard');
                    standardAvgClosed.classList.remove('standard-meets');
                    standardAvgClosed.classList.add('standard-below');
                    standardAvgClosed.textContent = "Por debajo del estándar";
                }
                
                // Verificar estándar para casos gestionados
                if (managedPerHour >= STANDARD_MANAGED_PER_HOUR) {
                    avgManaged.classList.remove('stat-below-standard');
                    avgManaged.classList.add('stat-meets-standard');
                    standardAvgManaged.classList.remove('standard-below');
                    standardAvgManaged.classList.add('standard-meets');
                    standardAvgManaged.textContent = "Cumple el estándar";
                } else {
                    avgManaged.classList.remove('stat-meets-standard');
                    avgManaged.classList.add('stat-below-standard');
                    standardAvgManaged.classList.remove('standard-meets');
                    standardAvgManaged.classList.add('standard-below');
                    standardAvgManaged.textContent = "Por debajo del estándar";
                }
                
                // Verificar estándar para casos totales por hora
                if (managedPerHour >= STANDARD_MANAGED_PER_HOUR) {
                    casesPerHour.classList.remove('stat-below-standard');
                    casesPerHour.classList.add('stat-meets-standard');
                    standardCasesPerHour.classList.remove('standard-below');
                    standardCasesPerHour.classList.add('standard-meets');
                    standardCasesPerHour.textContent = "Cumple el estándar";
                } else {
                    casesPerHour.classList.remove('stat-meets-standard');
                    casesPerHour.classList.add('stat-below-standard');
                    standardCasesPerHour.classList.remove('standard-meets');
                    standardCasesPerHour.classList.add('standard-below');
                    standardCasesPerHour.textContent = "Por debajo del estándar";
                }
            }
            
            // Función para actualizar estadísticas
            function updateStats() {
                // Porcentaje de cierre
                const percentage = managedCount > 0 ? ((closedCount / managedCount) * 100).toFixed(1) : 0;
                closeRate.textContent = percentage + '%';
                
                // Calcular métricas basadas en tiempo
                const totalSeconds = seconds + (minutes * 60) + (hours * 3600);
                const totalHours = totalSeconds / 3600;
                
                let closedPerHour = 0;
                let managedPerHour = 0;
                let totalPerHour = 0;
                
                if (totalSeconds > 0) {
                    // Casos por hora (total)
                    totalPerHour = totalHours > 0 ? ((managedCount) / totalHours).toFixed(1) : 0;
                    casesPerHour.textContent = totalPerHour;
                    
                    // Promedio de casos cerrados por hora
                    closedPerHour = totalHours > 0 ? (closedCount / totalHours).toFixed(1) : 0;
                    avgClosed.textContent = closedPerHour;
                    
                    // Promedio de casos gestionados por hora
                    managedPerHour = totalHours > 0 ? (managedCount / totalHours).toFixed(1) : 0;
                    avgManaged.textContent = managedPerHour;
                    
                    // Actualizar indicadores de estándares
                    actualizarIndicadoresEstandares(closedPerHour, managedPerHour);
                }
                
                // Actualizar estado de botones
                actualizarEstadoBotones();
            }
            
            // Función para actualizar el temporizador
            function updateTimer() {
                seconds++;
                
                if (seconds >= 60) {
                    seconds = 0;
                    minutes++;
                    
                    if (minutes >= 60) {
                        minutes = 0;
                        hours++;
                    }
                }
                
                // Formatear el tiempo como HH:MM:SS
                const formattedTime = [
                    hours.toString().padStart(2, "0"),
                    minutes.toString().padStart(2, "0"),
                    seconds.toString().padStart(2, "0")
                ].join(":");
                
                timer.textContent = formattedTime;
                updateStats();
            }
            
            // Evento para casos cerrados
            btnClosed.addEventListener('click', function() {
                // Verificar que no haya más casos cerrados que gestionados
                if (closedCount >= managedCount) {
                    mostrarError("No puedes cerrar más casos de los que has gestionado");
                    return;
                }
                
                closedCount++;
                casesClosed.textContent = closedCount;
                updateStats();
            });
            
            // Evento para casos gestionados
            btnManaged.addEventListener('click', function() {
                managedCount++;
                casesManaged.textContent = managedCount;
                updateStats();
            });
            
            // Evento para iniciar/detener el temporizador
            btnTimer.addEventListener('click', function() {
                if (timerRunning) {
                    // Detener el temporizador
                    clearInterval(timerInterval);
                    btnTimer.textContent = "Iniciar Tiempo";
                    mensajeInfo.textContent = "Tiempo detenido. Inicia el tiempo para continuar registrando casos";
                    mensajeInfo.style.display = "block";
                } else {
                    // Iniciar el temporizador
                    timerInterval = setInterval(updateTimer, 1000);
                    btnTimer.textContent = "Detener Tiempo";
                    mensajeInfo.style.display = "none";
                }
                
                timerRunning = !timerRunning;
                actualizarEstadoBotones();
            });
            
            // Evento para reiniciar
            btnReset.addEventListener('click', function() {
                // Reiniciar contadores
                closedCount = 0;
                managedCount = 0;
                
                // Reiniciar temporizador
                clearInterval(timerInterval);
                timerRunning = false;
                seconds = 0;
                minutes = 0;
                hours = 0;
                
                // Actualizar la interfaz
                casesClosed.textContent = '0';
                casesManaged.textContent = '0';
                closeRate.textContent = '0%';
                casesPerHour.textContent = '0';
                avgClosed.textContent = '0';
                avgManaged.textContent = '0';
                timer.textContent = '00:00:00';
                btnTimer.textContent = "Iniciar Tiempo";
                
                // Restablecer mensaje de información
                mensajeInfo.textContent = "Inicia el tiempo para comenzar a registrar casos";
                mensajeInfo.style.display = "block";
                
                // Restablecer indicadores de estándares
                avgClosed.classList.remove('stat-meets-standard');
                avgClosed.classList.add('stat-below-standard');
                standardAvgClosed.classList.remove('standard-meets');
                standardAvgClosed.classList.add('standard-below');
                standardAvgClosed.textContent = "Por debajo del estándar";
                
                avgManaged.classList.remove('stat-meets-standard');
                avgManaged.classList.add('stat-below-standard');
                standardAvgManaged.classList.remove('standard-meets');
                standardAvgManaged.classList.add('standard-below');
                standardAvgManaged.textContent = "Por debajo del estándar";
                
                casesPerHour.classList.remove('stat-meets-standard');
                casesPerHour.classList.add('stat-below-standard');
                standardCasesPerHour.classList.remove('standard-meets');
                standardCasesPerHour.classList.add('standard-below');
                standardCasesPerHour.textContent = "Por debajo del estándar";
                
                // Resetear estado de botones
                actualizarEstadoBotones();
            });
            
            // Inicializar estado de botones
            actualizarEstadoBotones();
        });
    </script>
</body>
</html>
